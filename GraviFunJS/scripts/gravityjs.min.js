function getviewheight(){for(var e=gravElement.parentNode,s=!1;!s;){if("BODY"===e.tagName)return s=!0,window.innerHeight;if(void 0!==e.offsetHeight&&e.offsetHeight>0)return s=!0,e.offsetHeight>window.innerHeight?window.innerHeight:e.offsetHeight;e=e.parentNode}}function MouseGrav(e){this.posX=e.offsetX,this.posY=e.offsetY,this.moveable=!0,this.MASS=1e-6,this.mass=function(){return this.MASS}}function Circle(e){this.posX=e.offsetX,this.posY=e.offsetY,this.velX=0,this.velY=0,this.forceX=0,this.forceY=0,this.radius=Math.floor(Math.random()*Math.min(windowWidth,windowHeight)*.005)+.002*Math.min(windowWidth,windowHeight),this.diameter=2*this.radius,this.mass=function(){return this.radius*this.radius*Math.PI*(1920/Math.min(windowWidth,windowHeight))},this.color="rgb("+Math.floor(255*Math.random())+","+Math.floor(255*Math.random())+","+Math.floor(255*Math.random())+")",this.absorb=function(e){this.radius++},this.stayOnScreen=function(){this.posX+this.radius>windowWidth&&(this.posX=windowWidth-this.radius,this.velX=-this.velX,this.forceX=-this.forceX),this.posX-this.radius<0&&(this.posX=this.radius,this.velX=-this.velX,this.forceX=-this.forceX),this.posY+this.radius>windowHeight&&(this.posY=windowHeight-this.radius,this.velY=-this.velY,this.forceY=-this.forceY),this.posY-this.radius<0&&(this.posY=this.radius,this.velY=-this.velY,this.forceY=-this.forceY)}}function viewGrav(){var e="";e+='<button id="g0" style="position:absolute; left:0; top:0; width:'+windowWidth/4+'px; height:30px; background-color:#777777; border:none; opacity:0.8; font-size:80%;">Gravity-0</button>',e+='<button id="g10" style="position:absolute; left:'+windowWidth/4+"px; top:0; width:"+windowWidth/4+'px; height:30px; background-color:#AA7777; border:none; opacity:0.8; font-size:80%;">Gravity-10</button>',e+='<button id="g50" style="position:absolute; left:'+windowWidth/2+"px; top:0; width:"+windowWidth/4+'px; height:30px; background-color:#77AA77; border:none; opacity:0.8; font-size:80%;">Gravity-50</button>',e+='<button id="g100" style="position:absolute; left:'+3*windowWidth/4+"px; top:0; width:"+windowWidth/4+'px; height:30px; background-color:#7777AA; border:none; opacity:0.8; font-size:70%;">Gravity-100</button>',e+='<button id="de" style="position:absolute; left:0px;  top:'+(windowHeight-30)+"px; width:"+windowWidth/4+'px; height:30px; background-color:#770077; border:none; opacity:0.8; font-size:75%;">Dark Energy</button>',e+='<button id="si" style="position:absolute; left:'+3*windowWidth/4+"px; top:"+(windowHeight-30)+"px; width:"+windowWidth/4+'px; height:30px; background-color:#AA77AA; border:none; opacity:0.8; font-size:80%;">Singularity</button>',e+='<button id="zeromass" style="position:absolute; left:'+windowWidth/4+"px; top:"+(windowHeight-30)+"px; width:"+windowWidth/2+'px; height:30px; background-color:#0077AA; border:none; opacity:0.8; font-size:80%;">Zero Mass</button>',e+='<svg id="gravRender" xmlns="http://www.w3.org/2000/svg" version="1.1" width="'+windowWidth+'" height="'+windowHeight+'" viewBox="0,0,'+windowWidth+","+windowHeight+'">';for(cirs in circles)circles[cirs].radius>.03*windowWidth&&circles[cirs].radius<.28*windowWidth?(e+=" <defs>",e+=' <radialGradient id="f'+cirs+'" cx="50%" cy="50%" r="'+circles[cirs].radius/(.28*windowWidth)*100+'%" fx="50%" fy="50%">',e+=' <stop offset="30%" style="stop-color:'+circles[cirs].color+';stop-opacity:0" />',e+='<stop offset="100%" style="stop-color:'+circles[cirs].color+';stop-opacity:1" />',e+="</radialGradient>",e+=" </defs>",e+='<circle cx="'+circles[cirs].posX+'" cy="'+circles[cirs].posY+'" r="'+circles[cirs].radius+'"   fill="url(#f'+cirs+')"/>'):circles[cirs].radius>=.28*windowWidth?(e+=" <defs>",e+=' <radialGradient id="f'+cirs+'" cx="50%" cy="50%" r="90%" fx="50%" fy="50%">',e+=' <stop offset="0%" style="stop-color:rgb(255,255,255); stop-opacity:1" />',e+='<stop offset="20%" style="stop-color:'+circles[cirs].color+';stop-opacity:0" />',e+="</radialGradient>",e+=" </defs>",e+='<circle cx="'+circles[cirs].posX+'" cy="'+circles[cirs].posY+'" r="'+circles[cirs].radius+'"   fill="url(#f'+cirs+')"/>'):e+='<circle cx="'+circles[cirs].posX+'" cy="'+circles[cirs].posY+'" r="'+circles[cirs].radius+'" fill="'+circles[cirs].color+'" />';return e+='<circle cx="'+mouseGrav.posX+'" cy="'+mouseGrav.posY+'" r="'+.01*windowWidth+'" stroke-width="4" stroke="rgb(255,255,255)" />',e+=" Sorry, your browser does not support inline SVG.",e+="</svg>"}function windowChanges(){(gravElement.offsetWidth!==windowWidth||getviewheight()!==windowHeight)&&(assets=viewGrav(),windowWidth=gravElement.offsetWidth,/Android|webOS|iPhone|iPad|iPod|BlackBerry|BB|PlayBook|IEMobile|Windows Phone|Kindle|Silk|Opera Mini/i.test(navigator.userAgent)||(windowHeight=getviewheight(),gravElement.style.height=windowHeight+"px"))}function spawnCircle(){circles.unshift(new Circle({offsetX:Math.random()*windowWidth,offsetY:Math.random()*windowHeight}))}function runballs(e){return circles.length<e?(spawnCircle(),runballs(e)):void 0}function clear(){circles=[]}function play(){now=Date.now();var e=now-currentTime;runtime=now-startTime,currentTime=now;for(cirs in circles){circles[cirs].posX=circles[cirs].posX+e*circles[cirs].velX,circles[cirs].posY=circles[cirs].posY+e*circles[cirs].velY;var s=1;Math.sqrt(Math.pow(circles[cirs].velX,2)+Math.pow(circles[cirs].velX,2))*circles[cirs].mass()>20&&(s=.95),circles[cirs].velX=s*circles[cirs].velX+circles[cirs].forceX/circles[cirs].mass()*e,circles[cirs].velY=s*circles[cirs].velY+circles[cirs].forceY/circles[cirs].mass()*e}var i=[],t=[];for(me in circles){circles[me].forceX=0,circles[me].forceY=0;for(them in circles)if(me!==them){var r=circles[them].posX-circles[me].posX,o=circles[them].posY-circles[me].posY,c=Math.sqrt(Math.pow(r,2)+Math.pow(o,2));if(c<circles[them].radius+circles[me].radius&&(c=circles[them].radius+circles[me].radius,circles[them].radius<circles[me].radius)){var n=!1;for(abs in i)if(i[abs].absorbs===me&&i[abs].absorbs===them){n=!0;break}n||i.push({who:me,absorbs:them})}var a=GravC*circles[me].mass()*circles[them].mass()/(c*c);circles[me].forceX=circles[me].forceX+a*(r/c),circles[me].forceY=circles[me].forceY+a*(o/c)}var l=mouseGrav.posX-circles[me].posX,d=mouseGrav.posY-circles[me].posY,h=Math.sqrt(Math.pow(l,2)+Math.pow(d,2));h<circles[me].radius&&(h=circles[me].radius);var m=GravC*circles[me].mass()*mouseGrav.mass()/(h*h);circles[me].forceX=circles[me].forceX+m*(l/h),circles[me].forceY=circles[me].forceY+m*(d/h),circles[me].stayOnScreen(),circles[me].radius>.3*windowWidth&&t.push(me)}for(abs in i){var u=circles[Number(i[abs].who)].mass(),w=circles[Number(i[abs].who)].velX,f=circles[Number(i[abs].who)].velY;circles[Number(i[abs].who)].radius=Math.sqrt(Math.pow(circles[i[abs].who].radius,2)+Math.pow(circles[i[abs].absorbs].radius,2)),circles[Number(i[abs].who)].velX=(circles[Number(i[abs].who)].velX*u+circles[i[abs].absorbs].velX*circles[i[abs].absorbs].mass())/(u+circles[i[abs].absorbs].mass()),circles[Number(i[abs].who)].velY=(circles[Number(i[abs].who)].velY*u+circles[i[abs].absorbs].velY*circles[i[abs].absorbs].mass())/(u+circles[i[abs].absorbs].mass()),circles[Number(i[abs].who)].forceX=circles[Number(i[abs].who)].forceX+.1*(circles[i[abs].who].mass()*(circles[i[abs].who].velX-w))/e,circles[Number(i[abs].who)].forceY=circles[Number(i[abs].who)].forceY+.1*(circles[i[abs].who].mass()*(circles[i[abs].who].velY-f))/e;var v=circles.slice(Number(i[abs].absorbs)+1),g=circles.slice(0,Number(i[abs].absorbs));circles=[],circles=g.concat(v),spawnCircle()}for(me in t){var v=circles.slice(Number(t[me])+1),g=circles.slice(0,Number(t[me]));circles=[],circles=g.concat(v)}assets=viewGrav()}function handleInterface(e){"mousedown"===e.type&&(circles.push(new Circle(e)),e.target==document.getElementById("g0")?(clear(),runballs(0)):e.target==document.getElementById("g10")?(clear(),runballs(10)):e.target==document.getElementById("g50")?(clear(),runballs(50)):e.target==document.getElementById("g100")?(clear(),runballs(100)):e.target==document.getElementById("de")?mouseGrav.MASS=-5e4*(1920/windowWidth):e.target==document.getElementById("si")?mouseGrav.MASS=5e4*(1920/windowWidth):e.target==document.getElementById("zeromass")?mouseGrav.MASS=0:mouseGrav.moveable=!0,assets=viewGrav()),"mouseup"===e.type,"mousemove"===e.type&&"gravRender"==e.target.id&&mouseGrav.moveable&&(mouseGrav.posX=e.offsetX,mouseGrav.posY=e.offsetY),"dblclick"===e.type&&(mouseGrav.moveable=!1,mouseGrav.posX=e.offsetX,mouseGrav.posY=e.offsetY)}function render(){play(),gravElement.innerHTML=assets}function run(){requestAnimationFrame(function(){run()}),windowChanges(),render()}function playgame(){runballs(100),assets=viewGrav(),run()}var callCount=0,circles=[],gravElement=document.getElementById("gravContainer");gravElement.style.backgroundColor="#000000",gravElement.style.position="relative",gravElement.style.overflow="hidden",gravElement.style.padding=0,gravElement.style.margin=0;var windowWidth=gravElement.offsetWidth,windowHeight=0,par;windowHeight=getviewheight(),gravElement.style.height=windowHeight+"px";var assets,gravElement=document.getElementById("gravContainer"),GravC=5e-5*(windowWidth/1920),duration=1e3,currentTime=Date.now(),startTime=currentTime,runtime=0,now,zoomin=!1,mouseGrav=new MouseGrav({offsetX:windowWidth/2,offsetY:5e3});window.requestAnimationFrame||(window.requestAnimationFrame=function(){return window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e,s){window.setTimeout(e,1e3/60)}}()),gravElement.addEventListener("touchstart",function(e){var s=e.changedTouches[0];circles.push(new Circle({offsetX:s.pageX-gravElement.offsetLeft,offsetY:s.pageY-gravElement.offsetTop})),s.target==document.getElementById("g0")?(clear(),runballs(0)):s.target==document.getElementById("g10")?(clear(),runballs(10)):s.target==document.getElementById("g50")?(clear(),runballs(50)):s.target==document.getElementById("g100")?(clear(),runballs(100)):s.target==document.getElementById("de")?mouseGrav.MASS=-5e4*(1920/windowWidth):s.target==document.getElementById("si")?mouseGrav.MASS=5e4*(1920/windowWidth):s.target==document.getElementById("zeromass")?mouseGrav.MASS=0:(mouseGrav.posX=s.pageX-gravElement.offsetLeft,mouseGrav.posY=s.pageY-gravElement.offsetTop),assets=viewGrav(),e.preventDefault()}),gravElement.addEventListener("touchmove",function(e){var s=e.changedTouches[0];mouseGrav.posX=s.clientX-gravElement.offsetLeft,mouseGrav.posY=s.clientY-gravElement.offsetTop,assets=viewGrav(),e.preventDefault()}),gravElement.addEventListener("touchend",function(e){var s=e.changedTouches[0];mouseGrav.posX=s.pageX-gravElement.offsetLeft,mouseGrav.posY=s.pageY-gravElement.offsetTop,assets=viewGrav(),e.preventDefault()}),gravElement.ondblclick=function(e){handleInterface(e)},gravElement.onorientationchange=function(e){e.preventDefault()},gravElement.onmousemove=function(e){handleInterface(e),e.preventDefault()},gravElement.onmousedown=function(e){handleInterface(e),e.preventDefault()},gravElement.onmouseup=function(e){handleInterface(e),e.preventDefault()},playgame();
